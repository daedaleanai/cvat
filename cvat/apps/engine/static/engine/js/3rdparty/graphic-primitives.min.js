window.graphicPrimitives=function(t){var e={};function r(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(s,o,function(e){return t[e]}.bind(null,o));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const{findVanishingPoint:s,arePointsEqual:o,getLineByTwoPoints:n,fromPolarCoordinates:i,toPolarCoordinates:h,getAngleBetween:u,getOppositeAngle:l,rotate:a,getAngle:f,pointsDistance:c}=r(1);t.exports={findVanishingPoint:s,arePointsEqual:o,getLineByTwoPoints:n,fromPolarCoordinates:i,toPolarCoordinates:h,getAngleBetween:u,getOppositeAngle:l,rotate:a,getAngle:f,pointsDistance:c}},function(t,e,r){const{Matrix:s,solve:o}=r(2);function n(t,e=null){e&&(t={x:t.x-e.x,y:t.y-e.y});const{x:r,y:s}=t;return{r:Math.sqrt(r*r+s*s),phi:Math.atan2(s,r)}}function i(t,e){const r=2*Math.PI,s=Math.abs(t-e)%r;return s<Math.PI?s:r-s}function h(t,e){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function u(t){const e=new s(t.map(t=>[t.a,t.b])),r=s.columnVector(t.map(t=>-t.c));try{const t=o(e,r),s=t.get(0,0);return{x:s,y:t.get(1,0)}}catch(t){return null}}function l(t){const e=t.length;let r=0,s=0;t.forEach(t=>{let{a:e,b:o}=t;const n=Math.max(Math.abs(e),Math.abs(o));e/=n,o/=n,e<0&&(e=-e,o=-o),r+=e,s+=o});return{a:r/e,b:s/e}}function a(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function f(t,e){const r={a:t.y-e.y,b:e.x-t.x,c:t.x*e.y-e.x*t.y};return Math.abs(r.a)<Number.EPSILON&&Math.abs(r.b)<Number.EPSILON?null:r}function c(t,e){return g(e,{a:-e.b,b:e.a,c:e.b*t.x-e.a*t.y})}function g(t,e){const r=t.a*e.b-e.a*t.b;if(Math.abs(r)<Number.EPSILON)return null;return{x:(t.b*e.c-e.b*t.c)/r,y:(e.a*t.c-t.a*e.c)/r}}t.exports={intersectLines:g,projectOntoLine:c,getLineByTwoPoints:f,approximateLinesIntersection:u,approximateAngleFactor:l,arePointsEqual:function(t,e){return h(t,e)<.001},getMidPoint:a,findVanishingPoint:function(t,e){const r=t.map(t=>a(t[0],t[1])),s=t.map(t=>f(t[0],t[1]));let o,g=u(s);if(g&&(t=t.map(([t,e])=>h(e,g)<h(t,g)?[t,e]:[e,t])),g&&!function(t,e,r){if(!r)return!0;const s=e.map(e=>n(e,t).phi);let o=0;for(let t=0;t<s.length-1;t++)for(let e=t+1;e<s.length;e++){const r=i(s[t],s[e]);o=Math.max(o,r)}return o>r}(g,r,e)&&(g=null),g)o=r.map(t=>f(t,g));else{const t=l(s);o=r.map(e=>function(t,e){const{x:r,y:s}=t,{a:o,b:n}=e;return{a:o,b:n,c:-(o*r+n*s)}}(e,t))}return[t.map((t,e)=>[c(t[0],o[e]),c(t[1],o[e])]),g]},toPolarCoordinates:n,fromPolarCoordinates:function(t,e=null){const{r:r,phi:s}=t;let o=r*Math.cos(s),n=r*Math.sin(s);return e&&(o+=e.x,n+=e.y),{x:o,y:n}},getOppositeAngle:function(t){const e=2*Math.PI;return(e+t)%e-Math.PI},getAngleBetween:i,getAngle:function(t){return Math.atan2(-t.a,t.b)},rotate:function(t,e){const{x:r,y:s}=t;return{x:r*Math.cos(e)+s*Math.sin(e),y:-r*Math.sin(e)+s*Math.cos(e)}},pointsDistance:h}},function(t,e,r){"use strict";r.r(e),r.d(e,"AbstractMatrix",(function(){return v})),r.d(e,"default",(function(){return S})),r.d(e,"Matrix",(function(){return S})),r.d(e,"MatrixColumnView",(function(){return V})),r.d(e,"MatrixColumnSelectionView",(function(){return k})),r.d(e,"MatrixFlipColumnView",(function(){return T})),r.d(e,"MatrixFlipRowView",(function(){return q})),r.d(e,"MatrixRowView",(function(){return C})),r.d(e,"MatrixRowSelectionView",(function(){return P})),r.d(e,"MatrixSelectionView",(function(){return N})),r.d(e,"MatrixSubView",(function(){return j})),r.d(e,"MatrixTransposeView",(function(){return F})),r.d(e,"wrap",(function(){return O})),r.d(e,"WrapperMatrix1D",(function(){return D})),r.d(e,"WrapperMatrix2D",(function(){return L})),r.d(e,"solve",(function(){return Q})),r.d(e,"inverse",(function(){return B})),r.d(e,"determinant",(function(){return W})),r.d(e,"linearDependencies",(function(){return J})),r.d(e,"pseudoInverse",(function(){return X})),r.d(e,"covariance",(function(){return G})),r.d(e,"correlation",(function(){return K})),r.d(e,"SingularValueDecomposition",(function(){return _})),r.d(e,"SVD",(function(){return _})),r.d(e,"EigenvalueDecomposition",(function(){return Z})),r.d(e,"EVD",(function(){return Z})),r.d(e,"CholeskyDecomposition",(function(){return et})),r.d(e,"CHO",(function(){return et})),r.d(e,"LuDecomposition",(function(){return z})),r.d(e,"LU",(function(){return z})),r.d(e,"QrDecomposition",(function(){return $})),r.d(e,"QR",(function(){return $})),r.d(e,"Nipals",(function(){return rt})),r.d(e,"NIPALS",(function(){return rt}));const s=Object.prototype.toString;function o(t){return s.call(t).endsWith("Array]")}var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,s=void 0===r?0:r,n=e.toIndex,i=void 0===n?t.length:n;if(s<0||s>=t.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=s||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=t[s],u=s+1;u<i;u++)t[u]>h&&(h=t[u]);return h};var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,s=void 0===r?0:r,n=e.toIndex,i=void 0===n?t.length:n;if(s<0||s>=t.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=s||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=t[s],u=s+1;u<i;u++)t[u]<h&&(h=t[u]);return h};var h=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!o(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var s=i(t),h=n(t);if(s===h)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var u=r.min,l=void 0===u?r.autoMinMax?s:0:u,a=r.max,f=void 0===a?r.autoMinMax?h:1:a;if(l>=f)throw new RangeError("min option must be smaller than max option");for(var c=(f-l)/(h-s),g=0;g<t.length;g++)e[g]=(t[g]-s)*c+l;return e};const u=" ".repeat(2),l=" ".repeat(4);function a(t,e={}){const{maxRows:r=15,maxColumns:s=10,maxNumSize:o=8}=e;return`${t.constructor.name} {\n${u}[\n${l}${function(t,e,r,s){const{rows:o,columns:n}=t,i=Math.min(o,e),h=Math.min(n,r),u=[];for(let e=0;e<i;e++){let r=[];for(let o=0;o<h;o++)r.push(f(t.get(e,o),s));u.push(""+r.join(" "))}h!==n&&(u[u.length-1]+=` ... ${n-r} more columns`);i!==o&&u.push(`... ${o-e} more rows`);return u.join("\n"+l)}(t,r,s,o)}\n${u}]\n${u}rows: ${t.rows}\n${u}columns: ${t.columns}\n}`}function f(t,e){const r=String(t);if(r.length<=e)return r.padEnd(e," ");const s=t.toPrecision(e-2);if(s.length<=e)return s;const o=t.toExponential(e-2),n=o.indexOf("e"),i=o.slice(n);return o.slice(0,e-i.length)+i}function c(t,e,r){let s=r?t.rows:t.rows-1;if(e<0||e>s)throw new RangeError("Row index out of range")}function g(t,e,r){let s=r?t.columns:t.columns-1;if(e<0||e>s)throw new RangeError("Column index out of range")}function m(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function w(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function p(t,e,r){return{row:d(t,e),column:M(t,r)}}function d(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function M(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function b(t,e,r,s,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(x("startRow",e),x("endRow",r),x("startColumn",s),x("endColumn",o),e>r||s>o||e<0||e>=t.rows||r<0||r>=t.rows||s<0||s>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function y(t,e=0){let r=[];for(let s=0;s<t;s++)r.push(e);return r}function x(t,e){if("number"!=typeof e)throw new TypeError(t+" must be a number")}class v{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let s=new S(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)s.set(o,t,r[o*e+t]);return s}static rowVector(t){let e=new S(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new S(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new S(t,e)}static ones(t,e){return new S(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:s=Math.random}=r;let o=new S(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,s());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:s=0,max:o=1e3,random:n=Math.random}=r;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(s>=o)throw new RangeError("min must be smaller than max");let i=o-s,h=new S(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=s+Math.round(n()*i);h.set(r,t,e)}return h}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let s=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<s;t++)o.set(t,t,r);return o}static diag(t,e,r){let s=t.length;void 0===e&&(e=s),void 0===r&&(r=e);let o=Math.min(s,e,r),n=this.zeros(e,r);for(let e=0;e<o;e++)n.set(e,e,t[e]);return n}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,o=new S(r,s);for(let n=0;n<r;n++)for(let r=0;r<s;r++)o.set(n,r,Math.min(t.get(n,r),e.get(n,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,o=new this(r,s);for(let n=0;n<r;n++)for(let r=0;r<s;r++)o.set(n,r,Math.max(t.get(n,r),e.get(n,r)));return o}static checkMatrix(t){return v.isMatrix(t)?t:new S(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(s=!1,o=!0);t++}return s}isReducedEchelonForm(){let t=0,e=0,r=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(s=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(s=!1);t++}return s}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let s=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(s,r)&&(s=o);if(0===t.get(s,r))r++;else{t.swapRows(e,s);let o=t.get(e,r);for(let s=r;s<t.columns;s++)t.set(e,s,t.get(e,s)/o);for(let s=e+1;s<t.rows;s++){let o=t.get(s,r)/t.get(e,r);t.set(s,r,0);for(let n=r+1;n<t.columns;n++)t.set(s,n,t.get(s,n)-t.get(e,n)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,s=r-1;for(;s>=0;)if(0===t.maxRow(s))s--;else{let o=0,n=!1;for(;o<r&&!1===n;)1===t.get(s,o)?n=!0:o++;for(let r=0;r<s;r++){let n=t.get(r,o);for(let i=o;i<e;i++){let e=t.get(r,i)-n*t.get(s,i);t.set(r,i,e)}}s--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let s=new S(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)s.setSubMatrix(this,this.rows*t,this.columns*e);return s}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return S.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=m(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){c(this,t),c(this,e);for(let r=0;r<this.columns;r++){let s=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,s)}return this}getColumn(t){g(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return S.columnVector(this.getColumn(t))}setColumn(t,e){g(this,t),e=w(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){g(this,t),g(this,e);for(let r=0;r<this.rows;r++){let s=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,s)}return this}addRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){c(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){g(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}min(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}maxRow(t){c(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){c(this,t);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)>e&&(e=this.get(t,s),r[1]=s);return r}minRow(t){c(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){c(this,t);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)<e&&(e=this.get(t,s),r[1]=s);return r}maxColumn(t){g(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){g(this,t);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)>e&&(e=this.get(s,t),r[0]=s);return r}minColumn(t){g(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){g(this,t);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)<e&&(e=this.get(s,t),r[0]=s);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError("unknown norm type: "+t)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){v.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let s=0;s<e.length;s++)r+=e[s]*t[s];return r}mmul(t){t=S.checkMatrix(t);let e=this.rows,r=this.columns,s=t.columns,o=new S(e,s),n=new Float64Array(r);for(let i=0;i<s;i++){for(let e=0;e<r;e++)n[e]=t.get(e,i);for(let t=0;t<e;t++){let e=0;for(let s=0;s<r;s++)e+=this.get(t,s)*n[s];o.set(t,i,e)}}return o}strassen2x2(t){t=S.checkMatrix(t);let e=new S(2,2);const r=this.get(0,0),s=t.get(0,0),o=this.get(0,1),n=t.get(0,1),i=this.get(1,0),h=t.get(1,0),u=this.get(1,1),l=t.get(1,1),a=(r+u)*(s+l),f=(i+u)*s,c=r*(n-l),g=u*(h-s),m=(r+o)*l,w=a+g-m+(o-u)*(h+l),p=c+m,d=f+g,M=a-f+c+(i-r)*(s+n);return e.set(0,0,w),e.set(0,1,p),e.set(1,0,d),e.set(1,1,M),e}strassen3x3(t){t=S.checkMatrix(t);let e=new S(3,3);const r=this.get(0,0),s=this.get(0,1),o=this.get(0,2),n=this.get(1,0),i=this.get(1,1),h=this.get(1,2),u=this.get(2,0),l=this.get(2,1),a=this.get(2,2),f=t.get(0,0),c=t.get(0,1),g=t.get(0,2),m=t.get(1,0),w=t.get(1,1),p=t.get(1,2),d=t.get(2,0),M=t.get(2,1),b=t.get(2,2),y=(r-n)*(-c+w),x=(-r+n+i)*(f-c+w),v=(n+i)*(-f+c),E=r*f,R=(-r+u+l)*(f-g+p),A=(-r+u)*(g-p),I=(u+l)*(-f+g),V=(-o+l+a)*(w+d-M),k=(o-a)*(w-M),T=o*d,q=(l+a)*(-d+M),C=(-o+i+h)*(p+d-b),P=(o-h)*(p-b),N=(i+h)*(-d+b),j=E+T+s*m,F=(r+s+o-n-i-l-a)*w+x+v+E+V+T+q,D=E+R+I+(r+s+o-i-h-u-l)*p+T+C+N,L=y+i*(-f+c+m-w-p-d+b)+x+E+T+C+P,O=y+x+v+E+h*M,z=T+C+P+N+n*g,U=E+R+A+l*(-f+g+m-w-p-d+M)+V+k+T,$=V+k+T+q+u*c,_=E+R+A+I+a*b;return e.set(0,0,j),e.set(0,1,F),e.set(0,2,D),e.set(1,0,L),e.set(1,1,O),e.set(1,2,z),e.set(2,0,U),e.set(2,1,$),e.set(2,2,_),e}mmulStrassen(t){t=S.checkMatrix(t);let e=this.clone(),r=e.rows,s=e.columns,o=t.rows,n=t.columns;function i(t,e,r){let s=t.rows,o=t.columns;if(s===e&&o===r)return t;{let s=v.zeros(e,r);return s=s.setSubMatrix(t,0,0),s}}s!==o&&console.warn(`Multiplying ${r} x ${s} and ${o} x ${n} matrix: dimensions do not match.`);let h=Math.max(r,o),u=Math.max(s,n);return e=i(e,h,u),function t(e,r,s,o){if(s<=512||o<=512)return e.mmul(r);s%2==1&&o%2==1?(e=i(e,s+1,o+1),r=i(r,s+1,o+1)):s%2==1?(e=i(e,s+1,o),r=i(r,s+1,o)):o%2==1&&(e=i(e,s,o+1),r=i(r,s,o+1));let n=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),u=e.subMatrix(0,n-1,0,h-1),l=r.subMatrix(0,n-1,0,h-1),a=e.subMatrix(0,n-1,h,e.columns-1),f=r.subMatrix(0,n-1,h,r.columns-1),c=e.subMatrix(n,e.rows-1,0,h-1),g=r.subMatrix(n,r.rows-1,0,h-1),m=e.subMatrix(n,e.rows-1,h,e.columns-1),w=r.subMatrix(n,r.rows-1,h,r.columns-1),p=t(v.add(u,m),v.add(l,w),n,h),d=t(v.add(c,m),l,n,h),M=t(u,v.sub(f,w),n,h),b=t(m,v.sub(g,l),n,h),y=t(v.add(u,a),w,n,h),x=t(v.sub(c,u),v.add(l,f),n,h),E=t(v.sub(a,m),v.add(g,w),n,h),S=v.add(p,b);S.sub(y),S.add(E);let R=v.add(M,y),A=v.add(d,b),I=v.sub(p,d);I.add(M),I.add(x);let V=v.zeros(2*S.rows,2*S.columns);return V=V.setSubMatrix(S,0,0),V=V.setSubMatrix(R,S.rows,0),V=V.setSubMatrix(A,0,S.columns),V=V.setSubMatrix(I,S.rows,S.columns),V.subMatrix(0,s-1,0,o-1)}(e,t=i(t,h,u),h,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let s=new S(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);h(o,{min:e,max:r,output:o}),s.setRow(t,o)}return s}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let s=new S(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);h(o,{min:e,max:r,output:o}),s.setColumn(t,o)}return s}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),s=this.get(e,this.columns-1-r);this.set(e,r,s),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),s=this.get(this.rows-1-r,e);this.set(r,e,s),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=S.checkMatrix(t);let e=this.rows,r=this.columns,s=t.rows,o=t.columns,n=new S(e*s,r*o);for(let i=0;i<e;i++)for(let e=0;e<r;e++)for(let r=0;r<s;r++)for(let h=0;h<o;h++)n.set(s*i+r,o*e+h,this.get(i,e)*t.get(r,h));return n}transpose(){let t=new S(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=E){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=E){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,s){b(this,t,e,r,s);let o=new S(e-t+1,s-r+1);for(let n=t;n<=e;n++)for(let e=r;e<=s;e++)o.set(n-t,e-r,this.get(n,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let s=new S(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let n=e;n<=r;n++){if(t[o]<0||t[o]>=this.rows)throw new RangeError("Row index out of range: "+t[o]);s.set(o,n-e,this.get(t[o],n))}return s}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let s=new S(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let n=e;n<=r;n++){if(t[o]<0||t[o]>=this.columns)throw new RangeError("Column index out of range: "+t[o]);s.set(n-e,o,this.get(n,t[o]))}return s}setSubMatrix(t,e,r){b(this,e,e+(t=S.checkMatrix(t)).rows-1,r,r+t.columns-1);for(let s=0;s<t.rows;s++)for(let o=0;o<t.columns;o++)this.set(e+s,r+o,t.get(s,o));return this}selection(t,e){let r=p(this,t,e),s=new S(t.length,e.length);for(let t=0;t<r.row.length;t++){let e=r.row[t];for(let o=0;o<r.column.length;o++){let n=r.column[o];s.set(t,o,this.get(e,n))}}return s}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new S(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=y(t.rows);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]+=t.get(r,s);return e}(this);case"column":return function(t){let e=y(t.columns);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]+=t.get(r,s);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e+=t.get(r,s);return e}(this);default:throw new Error("invalid option: "+t)}}product(t){switch(t){case"row":return function(t){let e=y(t.rows,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]*=t.get(r,s);return e}(this);case"column":return function(t){let e=y(t.columns,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]*=t.get(r,s);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e*=t.get(r,s);return e}(this);default:throw new Error("invalid option: "+t)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: "+t)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:s=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(s))throw new TypeError("mean must be an array");return function(t,e,r){const s=t.rows,o=t.columns,n=[];for(let i=0;i<s;i++){let s=0,h=0,u=0;for(let e=0;e<o;e++)u=t.get(i,e)-r[i],s+=u,h+=u*u;e?n.push((h-s*s/o)/(o-1)):n.push((h-s*s/o)/o)}return n}(this,r,s);case"column":if(!Array.isArray(s))throw new TypeError("mean must be an array");return function(t,e,r){const s=t.rows,o=t.columns,n=[];for(let i=0;i<o;i++){let o=0,h=0,u=0;for(let e=0;e<s;e++)u=t.get(e,i)-r[i],o+=u,h+=u*u;e?n.push((h-o*o/s)/(s-1)):n.push((h-o*o/s)/s)}return n}(this,r,s);case void 0:if("number"!=typeof s)throw new TypeError("mean must be a number");return function(t,e,r){const s=t.rows,o=t.columns,n=s*o;let i=0,h=0,u=0;for(let e=0;e<s;e++)for(let s=0;s<o;s++)u=t.get(e,s)-r,i+=u,h+=u*u;return e?(h-i*i/n)/(n-1):(h-i*i/n)/n}(this,r,s);default:throw new Error("invalid option: "+t)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[s])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e)}(this,r),this;default:throw new Error("invalid option: "+t)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let s=0;for(let e=0;e<t.columns;e++)s+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(s))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let s=0;for(let e=0;e<t.rows;e++)s+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(s))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[s])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let s=0;s<t.columns;s++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,s),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e)}(this,r),this;default:throw new Error("invalid option: "+t)}}toString(t){return a(this,t)}}function E(t,e){return t-e}v.prototype.klass="Matrix","undefined"!=typeof Symbol&&(v.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),v.random=v.rand,v.randomInt=v.randInt,v.diagonal=v.diag,v.prototype.diagonal=v.prototype.diag,v.identity=v.eye,v.prototype.negate=v.prototype.neg,v.prototype.tensorProduct=v.prototype.kroneckerProduct;class S extends v{constructor(t,e){if(super(),S.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(this.data=[],!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<t;s++){if(r[s].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[s]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){if(c(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(m(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(g(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let s=0;s<t;s++)r[s]=this.data[e][s];for(let s=t+1;s<this.columns;s++)r[s-1]=this.data[e][s];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),g(this,t,!0),e=w(this,e);for(let r=0;r<this.rows;r++){const s=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)s[o]=this.data[r][o];for(s[o++]=e[r];o<this.columns+1;o++)s[o]=this.data[r][o-1];this.data[r]=s}return this.columns+=1,this}}var R,A;A=S,(R=v).prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},R.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},R.prototype.addM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},R.add=function(t,e){return new A(t).add(e)},R.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},R.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},R.prototype.subM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},R.sub=function(t,e){return new A(t).sub(e)},R.prototype.subtract=R.prototype.sub,R.prototype.subtractS=R.prototype.subS,R.prototype.subtractM=R.prototype.subM,R.subtract=R.sub,R.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},R.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},R.prototype.mulM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},R.mul=function(t,e){return new A(t).mul(e)},R.prototype.multiply=R.prototype.mul,R.prototype.multiplyS=R.prototype.mulS,R.prototype.multiplyM=R.prototype.mulM,R.multiply=R.mul,R.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},R.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},R.prototype.divM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},R.div=function(t,e){return new A(t).div(e)},R.prototype.divide=R.prototype.div,R.prototype.divideS=R.prototype.divS,R.prototype.divideM=R.prototype.divM,R.divide=R.div,R.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},R.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},R.prototype.modM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},R.mod=function(t,e){return new A(t).mod(e)},R.prototype.modulus=R.prototype.mod,R.prototype.modulusS=R.prototype.modS,R.prototype.modulusM=R.prototype.modM,R.modulus=R.mod,R.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},R.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},R.prototype.andM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},R.and=function(t,e){return new A(t).and(e)},R.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},R.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},R.prototype.orM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},R.or=function(t,e){return new A(t).or(e)},R.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},R.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},R.prototype.xorM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},R.xor=function(t,e){return new A(t).xor(e)},R.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},R.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},R.prototype.leftShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},R.leftShift=function(t,e){return new A(t).leftShift(e)},R.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},R.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},R.prototype.signPropagatingRightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},R.signPropagatingRightShift=function(t,e){return new A(t).signPropagatingRightShift(e)},R.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},R.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},R.prototype.rightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},R.rightShift=function(t,e){return new A(t).rightShift(e)},R.prototype.zeroFillRightShift=R.prototype.rightShift,R.prototype.zeroFillRightShiftS=R.prototype.rightShiftS,R.prototype.zeroFillRightShiftM=R.prototype.rightShiftM,R.zeroFillRightShift=R.rightShift,R.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},R.not=function(t){return new A(t).not()},R.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},R.abs=function(t){return new A(t).abs()},R.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},R.acos=function(t){return new A(t).acos()},R.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},R.acosh=function(t){return new A(t).acosh()},R.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},R.asin=function(t){return new A(t).asin()},R.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},R.asinh=function(t){return new A(t).asinh()},R.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},R.atan=function(t){return new A(t).atan()},R.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},R.atanh=function(t){return new A(t).atanh()},R.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},R.cbrt=function(t){return new A(t).cbrt()},R.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},R.ceil=function(t){return new A(t).ceil()},R.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},R.clz32=function(t){return new A(t).clz32()},R.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},R.cos=function(t){return new A(t).cos()},R.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},R.cosh=function(t){return new A(t).cosh()},R.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},R.exp=function(t){return new A(t).exp()},R.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},R.expm1=function(t){return new A(t).expm1()},R.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},R.floor=function(t){return new A(t).floor()},R.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},R.fround=function(t){return new A(t).fround()},R.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},R.log=function(t){return new A(t).log()},R.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},R.log1p=function(t){return new A(t).log1p()},R.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},R.log10=function(t){return new A(t).log10()},R.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},R.log2=function(t){return new A(t).log2()},R.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},R.round=function(t){return new A(t).round()},R.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},R.sign=function(t){return new A(t).sign()},R.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},R.sin=function(t){return new A(t).sin()},R.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},R.sinh=function(t){return new A(t).sinh()},R.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},R.sqrt=function(t){return new A(t).sqrt()},R.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},R.tan=function(t){return new A(t).tan()},R.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},R.tanh=function(t){return new A(t).tanh()},R.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},R.trunc=function(t){return new A(t).trunc()},R.pow=function(t,e){return new A(t).pow(e)},R.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},R.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},R.prototype.powM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class I extends v{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class V extends I{constructor(t,e){g(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class k extends I{constructor(t,e){e=M(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class T extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}class q extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class C extends I{constructor(t,e){c(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class P extends I{constructor(t,e){super(t,(e=d(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class N extends I{constructor(t,e,r){let s=p(t,e,r);super(t,s.row.length,s.column.length),this.rowIndices=s.row,this.columnIndices=s.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class j extends I{constructor(t,e,r,s,o){b(t,e,r,s,o),super(t,r-e+1,o-s+1),this.startRow=e,this.startColumn=s}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class F extends I{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class D extends v{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let s=this._calculateIndex(t,e);return this.data[s]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class L extends v{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function O(t,e){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new L(t):new D(t,e);throw new Error("the argument is not an array")}class z{constructor(t){let e,r,s,o,n,i,h,u,l,a=(t=L.checkMatrix(t)).clone(),f=a.rows,c=a.columns,g=new Float64Array(f),m=1;for(e=0;e<f;e++)g[e]=e;for(u=new Float64Array(f),r=0;r<c;r++){for(e=0;e<f;e++)u[e]=a.get(e,r);for(e=0;e<f;e++){for(l=Math.min(e,r),n=0,s=0;s<l;s++)n+=a.get(e,s)*u[s];u[e]-=n,a.set(e,r,u[e])}for(o=r,e=r+1;e<f;e++)Math.abs(u[e])>Math.abs(u[o])&&(o=e);if(o!==r){for(s=0;s<c;s++)i=a.get(o,s),a.set(o,s,a.get(r,s)),a.set(r,s,i);h=g[o],g[o]=g[r],g[r]=h,m=-m}if(r<f&&0!==a.get(r,r))for(e=r+1;e<f;e++)a.set(e,r,a.get(e,r)/a.get(r,r))}this.LU=a,this.pivotVector=g,this.pivotSign=m}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=S.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,s,o,n=t.columns,i=t.subMatrixRow(this.pivotVector,0,n-1),h=e.columns;for(o=0;o<h;o++)for(r=o+1;r<h;r++)for(s=0;s<n;s++)i.set(r,s,i.get(r,s)-i.get(o,s)*e.get(r,o));for(o=h-1;o>=0;o--){for(s=0;s<n;s++)i.set(o,s,i.get(o,s)/e.get(o,o));for(r=0;r<o;r++)for(s=0;s<n;s++)i.set(r,s,i.get(r,s)-i.get(o,s)*e.get(r,o))}return i}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let s=0;s<r;s++)e*=t.get(s,s);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new S(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o>e?s.set(o,e,t.get(o,e)):o===e?s.set(o,e,1):s.set(o,e,0);return s}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new S(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o<=e?s.set(o,e,t.get(o,e)):s.set(o,e,0);return s}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function U(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class ${constructor(t){let e,r,s,o,n=(t=L.checkMatrix(t)).clone(),i=t.rows,h=t.columns,u=new Float64Array(h);for(s=0;s<h;s++){let t=0;for(e=s;e<i;e++)t=U(t,n.get(e,s));if(0!==t){for(n.get(s,s)<0&&(t=-t),e=s;e<i;e++)n.set(e,s,n.get(e,s)/t);for(n.set(s,s,n.get(s,s)+1),r=s+1;r<h;r++){for(o=0,e=s;e<i;e++)o+=n.get(e,s)*n.get(e,r);for(o=-o/n.get(s,s),e=s;e<i;e++)n.set(e,r,n.get(e,r)+o*n.get(e,s))}}u[s]=-t}this.QR=n,this.Rdiag=u}solve(t){t=S.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let s,o,n,i,h=t.columns,u=t.clone(),l=e.columns;for(n=0;n<l;n++)for(o=0;o<h;o++){for(i=0,s=n;s<r;s++)i+=e.get(s,n)*u.get(s,o);for(i=-i/e.get(n,n),s=n;s<r;s++)u.set(s,o,u.get(s,o)+i*e.get(s,n))}for(n=l-1;n>=0;n--){for(o=0;o<h;o++)u.set(n,o,u.get(n,o)/this.Rdiag[n]);for(s=0;s<n;s++)for(o=0;o<h;o++)u.set(s,o,u.get(s,o)-u.get(n,o)*e.get(s,n))}return u.subMatrix(0,l-1,0,h-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,s=r.columns,o=new S(s,s);for(t=0;t<s;t++)for(e=0;e<s;e++)t<e?o.set(t,e,r.get(t,e)):t===e?o.set(t,e,this.Rdiag[t]):o.set(t,e,0);return o}get orthogonalMatrix(){let t,e,r,s,o=this.QR,n=o.rows,i=o.columns,h=new S(n,i);for(r=i-1;r>=0;r--){for(t=0;t<n;t++)h.set(t,r,0);for(h.set(r,r,1),e=r;e<i;e++)if(0!==o.get(r,r)){for(s=0,t=r;t<n;t++)s+=o.get(t,r)*h.get(t,e);for(s=-s/o.get(r,r),t=r;t<n;t++)h.set(t,e,h.get(t,e)+s*o.get(t,r))}}return h}}class _{constructor(t,e={}){let r=(t=L.checkMatrix(t)).rows,s=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:n=!0,autoTranspose:i=!1}=e;let h,u=Boolean(o),l=Boolean(n),a=!1;if(r<s)if(i){h=t.transpose(),r=h.rows,s=h.columns,a=!0;let e=u;u=l,l=e}else h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else h=t.clone();let f=Math.min(r,s),c=Math.min(r+1,s),g=new Float64Array(c),m=new S(r,f),w=new S(s,s),p=new Float64Array(s),d=new Float64Array(r),M=new Float64Array(c);for(let t=0;t<c;t++)M[t]=t;let b=Math.min(r-1,s),y=Math.max(0,Math.min(s-2,r)),x=Math.max(b,y);for(let t=0;t<x;t++){if(t<b){g[t]=0;for(let e=t;e<r;e++)g[t]=U(g[t],h.get(e,t));if(0!==g[t]){h.get(t,t)<0&&(g[t]=-g[t]);for(let e=t;e<r;e++)h.set(e,t,h.get(e,t)/g[t]);h.set(t,t,h.get(t,t)+1)}g[t]=-g[t]}for(let e=t+1;e<s;e++){if(t<b&&0!==g[t]){let s=0;for(let o=t;o<r;o++)s+=h.get(o,t)*h.get(o,e);s=-s/h.get(t,t);for(let o=t;o<r;o++)h.set(o,e,h.get(o,e)+s*h.get(o,t))}p[e]=h.get(t,e)}if(u&&t<b)for(let e=t;e<r;e++)m.set(e,t,h.get(e,t));if(t<y){p[t]=0;for(let e=t+1;e<s;e++)p[t]=U(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<s;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<r&&0!==p[t]){for(let e=t+1;e<r;e++)d[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<s;r++)d[e]+=p[r]*h.get(e,r);for(let e=t+1;e<s;e++){let s=-p[e]/p[t+1];for(let o=t+1;o<r;o++)h.set(o,e,h.get(o,e)+s*d[o])}}if(l)for(let e=t+1;e<s;e++)w.set(e,t,p[e])}}let v=Math.min(s,r+1);if(b<s&&(g[b]=h.get(b,b)),r<v&&(g[v-1]=0),y+1<v&&(p[y]=h.get(y,v-1)),p[v-1]=0,u){for(let t=b;t<f;t++){for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<f;e++){let s=0;for(let o=t;o<r;o++)s+=m.get(o,t)*m.get(o,e);s=-s/m.get(t,t);for(let o=t;o<r;o++)m.set(o,e,m.get(o,e)+s*m.get(o,t))}for(let e=t;e<r;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}}if(l)for(let t=s-1;t>=0;t--){if(t<y&&0!==p[t])for(let e=t+1;e<s;e++){let r=0;for(let o=t+1;o<s;o++)r+=w.get(o,t)*w.get(o,e);r=-r/w.get(t+1,t);for(let o=t+1;o<s;o++)w.set(o,e,w.get(o,e)+r*w.get(o,t))}for(let e=0;e<s;e++)w.set(e,t,0);w.set(t,t,1)}let E=v-1,R=0,A=Number.EPSILON;for(;v>0;){let t,e;for(t=v-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+A*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===v-2)e=4;else{let r;for(r=v-1;r>=t&&r!==t;r--){let e=(r!==v?Math.abs(p[r]):0)+(r!==t+1?Math.abs(p[r-1]):0);if(Math.abs(g[r])<=A*e){g[r]=0;break}}r===t?e=3:r===v-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=p[v-2];p[v-2]=0;for(let r=v-2;r>=t;r--){let o=U(g[r],e),n=g[r]/o,i=e/o;if(g[r]=o,r!==t&&(e=-i*p[r-1],p[r-1]=n*p[r-1]),l)for(let t=0;t<s;t++)o=n*w.get(t,r)+i*w.get(t,v-1),w.set(t,v-1,-i*w.get(t,r)+n*w.get(t,v-1)),w.set(t,r,o)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let s=t;s<v;s++){let o=U(g[s],e),n=g[s]/o,i=e/o;if(g[s]=o,e=-i*p[s],p[s]=n*p[s],u)for(let e=0;e<r;e++)o=n*m.get(e,s)+i*m.get(e,t-1),m.set(e,t-1,-i*m.get(e,s)+n*m.get(e,t-1)),m.set(e,s,o)}break}case 3:{const e=Math.max(Math.abs(g[v-1]),Math.abs(g[v-2]),Math.abs(p[v-2]),Math.abs(g[t]),Math.abs(p[t])),o=g[v-1]/e,n=g[v-2]/e,i=p[v-2]/e,h=g[t]/e,a=p[t]/e,f=((n+o)*(n-o)+i*i)/2,c=o*i*(o*i);let d=0;0===f&&0===c||(d=f<0?0-Math.sqrt(f*f+c):Math.sqrt(f*f+c),d=c/(f+d));let M=(h+o)*(h-o)+d,b=h*a;for(let e=t;e<v-1;e++){let o=U(M,b);0===o&&(o=Number.MIN_VALUE);let n=M/o,i=b/o;if(e!==t&&(p[e-1]=o),M=n*g[e]+i*p[e],p[e]=n*p[e]-i*g[e],b=i*g[e+1],g[e+1]=n*g[e+1],l)for(let t=0;t<s;t++)o=n*w.get(t,e)+i*w.get(t,e+1),w.set(t,e+1,-i*w.get(t,e)+n*w.get(t,e+1)),w.set(t,e,o);if(o=U(M,b),0===o&&(o=Number.MIN_VALUE),n=M/o,i=b/o,g[e]=o,M=n*p[e]+i*g[e+1],g[e+1]=-i*p[e]+n*g[e+1],b=i*p[e+1],p[e+1]=n*p[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=n*m.get(t,e)+i*m.get(t,e+1),m.set(t,e+1,-i*m.get(t,e)+n*m.get(t,e+1)),m.set(t,e,o)}p[v-2]=M,R+=1;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,l))for(let e=0;e<=E;e++)w.set(e,t,-w.get(e,t));for(;t<E&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,l&&t<s-1)for(let r=0;r<s;r++)e=w.get(r,t+1),w.set(r,t+1,w.get(r,t)),w.set(r,t,e);if(u&&t<r-1)for(let s=0;s<r;s++)e=m.get(s,t+1),m.set(s,t+1,m.get(s,t)),m.set(s,t,e);t++}R=0,v--}}if(a){let t=w;w=m,m=t}this.m=r,this.n=s,this.s=g,this.U=m,this.V=w}solve(t){let e=t,r=this.threshold,s=this.s.length,o=S.zeros(s,s);for(let t=0;t<s;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let n=this.U,i=this.rightSingularVectors,h=i.mmul(o),u=i.rows,l=n.rows,a=S.zeros(u,l);for(let t=0;t<u;t++)for(let e=0;e<l;e++){let r=0;for(let o=0;o<s;o++)r+=h.get(t,o)*n.get(e,o);a.set(t,e,r)}return a.mmul(e)}solveForDiagonal(t){return this.solve(S.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,s=t.columns,o=new S(r,this.s.length);for(let n=0;n<r;n++)for(let r=0;r<s;r++)Math.abs(this.s[r])>e&&o.set(n,r,t.get(n,r)/this.s[r]);let n=this.U,i=n.rows,h=n.columns,u=new S(r,i);for(let t=0;t<r;t++)for(let e=0;e<i;e++){let r=0;for(let s=0;s<h;s++)r+=o.get(t,s)*n.get(e,s);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let s=0,o=r.length;s<o;s++)r[s]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return S.diag(this.s)}}function B(t,e=!1){return t=L.checkMatrix(t),e?new _(t).inverse():Q(t,S.eye(t.rows))}function Q(t,e,r=!1){return t=L.checkMatrix(t),e=L.checkMatrix(e),r?new _(t).solve(e):t.isSquare()?new z(t).solve(e):new $(t).solve(e)}function W(t){if((t=S.checkMatrix(t)).isSquare()){let e,r,s,o;if(2===t.columns)return e=t.get(0,0),r=t.get(0,1),s=t.get(1,0),o=t.get(1,1),e*o-r*s;if(3===t.columns){let o,n,i;return o=new N(t,[1,2],[1,2]),n=new N(t,[1,2],[0,2]),i=new N(t,[1,2],[0,1]),e=t.get(0,0),r=t.get(0,1),s=t.get(0,2),e*W(o)-r*W(n)+s*W(i)}return new z(t).determinant}throw Error("determinant can only be calculated for a square matrix")}function Y(t,e){let r=[];for(let s=0;s<t;s++)s!==e&&r.push(s);return r}function H(t,e,r,s=1e-9,o=1e-9){if(t>o)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<s&&t.set(e,0,0);return t.to1DArray()}}function J(t,e={}){const{thresholdValue:r=1e-9,thresholdError:s=1e-9}=e;let o=(t=S.checkMatrix(t)).rows,n=new S(o,o);for(let e=0;e<o;e++){let i=S.columnVector(t.getRow(e)),h=t.subMatrixRow(Y(o,e)).transpose(),u=new _(h).solve(i),l=S.sub(i,h.mmul(u)).abs().max();n.setRow(e,H(l,u,e,r,s))}return n}function X(t,e=Number.EPSILON){t=S.checkMatrix(t);let r=new _(t,{autoTranspose:!0}),s=r.leftSingularVectors,o=r.rightSingularVectors,n=r.diagonal;for(let t=0;t<n.length;t++)Math.abs(n[t])>e?n[t]=1/n[t]:n[t]=0;return o.mmul(S.diag(n).mmul(s.transpose()))}function G(t,e=t,r={}){t=new S(t);let s=!1;if("object"!=typeof e||S.isMatrix(e)||Array.isArray(e)?e=new S(e):(r=e,e=t,s=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=r;o&&(t=t.center("column"),s||(e=e.center("column")));const n=t.transpose().mmul(e);for(let e=0;e<n.rows;e++)for(let r=0;r<n.columns;r++)n.set(e,r,n.get(e,r)*(1/(t.rows-1)));return n}function K(t,e=t,r={}){t=new S(t);let s=!1;if("object"!=typeof e||S.isMatrix(e)||Array.isArray(e)?e=new S(e):(r=e,e=t,s=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:n=!0}=r;o&&(t.center("column"),s||e.center("column")),n&&(t.scale("column"),s||e.scale("column"));const i=t.standardDeviation("column",{unbiased:!0}),h=s?i:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let e=0;e<u.rows;e++)for(let r=0;r<u.columns;r++)u.set(e,r,u.get(e,r)*(1/(i[e]*h[r]))*(1/(t.rows-1)));return u}class Z{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=L.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");let s,o,n=t.columns,i=new S(n,n),h=new Float64Array(n),u=new Float64Array(n),l=t,a=!1;if(a=!!r||t.isSymmetric(),a){for(s=0;s<n;s++)for(o=0;o<n;o++)i.set(s,o,l.get(s,o));!function(t,e,r,s){let o,n,i,h,u,l,a,f;for(u=0;u<t;u++)r[u]=s.get(t-1,u);for(h=t-1;h>0;h--){for(f=0,i=0,l=0;l<h;l++)f+=Math.abs(r[l]);if(0===f)for(e[h]=r[h-1],u=0;u<h;u++)r[u]=s.get(h-1,u),s.set(h,u,0),s.set(u,h,0);else{for(l=0;l<h;l++)r[l]/=f,i+=r[l]*r[l];for(o=r[h-1],n=Math.sqrt(i),o>0&&(n=-n),e[h]=f*n,i-=o*n,r[h-1]=o-n,u=0;u<h;u++)e[u]=0;for(u=0;u<h;u++){for(o=r[u],s.set(u,h,o),n=e[u]+s.get(u,u)*o,l=u+1;l<=h-1;l++)n+=s.get(l,u)*r[l],e[l]+=s.get(l,u)*o;e[u]=n}for(o=0,u=0;u<h;u++)e[u]/=i,o+=e[u]*r[u];for(a=o/(i+i),u=0;u<h;u++)e[u]-=a*r[u];for(u=0;u<h;u++){for(o=r[u],n=e[u],l=u;l<=h-1;l++)s.set(l,u,s.get(l,u)-(o*e[l]+n*r[l]));r[u]=s.get(h-1,u),s.set(h,u,0)}}r[h]=i}for(h=0;h<t-1;h++){if(s.set(t-1,h,s.get(h,h)),s.set(h,h,1),i=r[h+1],0!==i){for(l=0;l<=h;l++)r[l]=s.get(l,h+1)/i;for(u=0;u<=h;u++){for(n=0,l=0;l<=h;l++)n+=s.get(l,h+1)*s.get(l,u);for(l=0;l<=h;l++)s.set(l,u,s.get(l,u)-n*r[l])}}for(l=0;l<=h;l++)s.set(l,h+1,0)}for(u=0;u<t;u++)r[u]=s.get(t-1,u),s.set(t-1,u,0);s.set(t-1,t-1,1),e[0]=0}(n,u,h,i),function(t,e,r,s){let o,n,i,h,u,l,a,f,c,g,m,w,p,d,M,b,y;for(i=1;i<t;i++)e[i-1]=e[i];e[t-1]=0;let x=0,v=0,E=Number.EPSILON;for(l=0;l<t;l++){for(v=Math.max(v,Math.abs(r[l])+Math.abs(e[l])),a=l;a<t&&!(Math.abs(e[a])<=E*v);)a++;if(a>l){y=0;do{for(y+=1,o=r[l],f=(r[l+1]-o)/(2*e[l]),c=U(f,1),f<0&&(c=-c),r[l]=e[l]/(f+c),r[l+1]=e[l]*(f+c),g=r[l+1],n=o-r[l],i=l+2;i<t;i++)r[i]-=n;for(x+=n,f=r[a],m=1,w=m,p=m,d=e[l+1],M=0,b=0,i=a-1;i>=l;i--)for(p=w,w=m,b=M,o=m*e[i],n=m*f,c=U(f,e[i]),e[i+1]=M*c,M=e[i]/c,m=f/c,f=m*r[i]-M*o,r[i+1]=n+M*(m*o+M*r[i]),u=0;u<t;u++)n=s.get(u,i+1),s.set(u,i+1,M*s.get(u,i)+m*n),s.set(u,i,m*s.get(u,i)-M*n);f=-M*b*p*d*e[l]/g,e[l]=M*f,r[l]=m*f}while(Math.abs(e[l])>E*v)}r[l]=r[l]+x,e[l]=0}for(i=0;i<t-1;i++){for(u=i,f=r[i],h=i+1;h<t;h++)r[h]<f&&(u=h,f=r[h]);if(u!==i)for(r[u]=r[i],r[i]=f,h=0;h<t;h++)f=s.get(h,i),s.set(h,i,s.get(h,u)),s.set(h,u,f)}}(n,u,h,i)}else{let t=new S(n,n),e=new Float64Array(n);for(o=0;o<n;o++)for(s=0;s<n;s++)t.set(s,o,l.get(s,o));!function(t,e,r,s){let o,n,i,h,u,l,a,f=t-1;for(l=1;l<=f-1;l++){for(a=0,h=l;h<=f;h++)a+=Math.abs(e.get(h,l-1));if(0!==a){for(i=0,h=f;h>=l;h--)r[h]=e.get(h,l-1)/a,i+=r[h]*r[h];for(n=Math.sqrt(i),r[l]>0&&(n=-n),i-=r[l]*n,r[l]=r[l]-n,u=l;u<t;u++){for(o=0,h=f;h>=l;h--)o+=r[h]*e.get(h,u);for(o/=i,h=l;h<=f;h++)e.set(h,u,e.get(h,u)-o*r[h])}for(h=0;h<=f;h++){for(o=0,u=f;u>=l;u--)o+=r[u]*e.get(h,u);for(o/=i,u=l;u<=f;u++)e.set(h,u,e.get(h,u)-o*r[u])}r[l]=a*r[l],e.set(l,l-1,a*n)}}for(h=0;h<t;h++)for(u=0;u<t;u++)s.set(h,u,h===u?1:0);for(l=f-1;l>=1;l--)if(0!==e.get(l,l-1)){for(h=l+1;h<=f;h++)r[h]=e.get(h,l-1);for(u=l;u<=f;u++){for(n=0,h=l;h<=f;h++)n+=r[h]*s.get(h,u);for(n=n/r[l]/e.get(l,l-1),h=l;h<=f;h++)s.set(h,u,s.get(h,u)+n*r[h])}}}(n,t,e,i),function(t,e,r,s,o){let n,i,h,u,l,a,f,c,g,m,w,p,d,M,b,y=t-1,x=t-1,v=Number.EPSILON,E=0,S=0,R=0,A=0,I=0,V=0,k=0,T=0;for(n=0;n<t;n++)for((n<0||n>x)&&(r[n]=o.get(n,n),e[n]=0),i=Math.max(n-1,0);i<t;i++)S+=Math.abs(o.get(n,i));for(;y>=0;){for(u=y;u>0&&(V=Math.abs(o.get(u-1,u-1))+Math.abs(o.get(u,u)),0===V&&(V=S),!(Math.abs(o.get(u,u-1))<v*V));)u--;if(u===y)o.set(y,y,o.get(y,y)+E),r[y]=o.get(y,y),e[y]=0,y--,T=0;else if(u===y-1){if(f=o.get(y,y-1)*o.get(y-1,y),R=(o.get(y-1,y-1)-o.get(y,y))/2,A=R*R+f,k=Math.sqrt(Math.abs(A)),o.set(y,y,o.get(y,y)+E),o.set(y-1,y-1,o.get(y-1,y-1)+E),c=o.get(y,y),A>=0){for(k=R>=0?R+k:R-k,r[y-1]=c+k,r[y]=r[y-1],0!==k&&(r[y]=c-f/k),e[y-1]=0,e[y]=0,c=o.get(y,y-1),V=Math.abs(c)+Math.abs(k),R=c/V,A=k/V,I=Math.sqrt(R*R+A*A),R/=I,A/=I,i=y-1;i<t;i++)k=o.get(y-1,i),o.set(y-1,i,A*k+R*o.get(y,i)),o.set(y,i,A*o.get(y,i)-R*k);for(n=0;n<=y;n++)k=o.get(n,y-1),o.set(n,y-1,A*k+R*o.get(n,y)),o.set(n,y,A*o.get(n,y)-R*k);for(n=0;n<=x;n++)k=s.get(n,y-1),s.set(n,y-1,A*k+R*s.get(n,y)),s.set(n,y,A*s.get(n,y)-R*k)}else r[y-1]=c+R,r[y]=c+R,e[y-1]=k,e[y]=-k;y-=2,T=0}else{if(c=o.get(y,y),g=0,f=0,u<y&&(g=o.get(y-1,y-1),f=o.get(y,y-1)*o.get(y-1,y)),10===T){for(E+=c,n=0;n<=y;n++)o.set(n,n,o.get(n,n)-c);V=Math.abs(o.get(y,y-1))+Math.abs(o.get(y-1,y-2)),c=g=.75*V,f=-.4375*V*V}if(30===T&&(V=(g-c)/2,V=V*V+f,V>0)){for(V=Math.sqrt(V),g<c&&(V=-V),V=c-f/((g-c)/2+V),n=0;n<=y;n++)o.set(n,n,o.get(n,n)-V);E+=V,c=g=f=.964}for(T+=1,l=y-2;l>=u&&(k=o.get(l,l),I=c-k,V=g-k,R=(I*V-f)/o.get(l+1,l)+o.get(l,l+1),A=o.get(l+1,l+1)-k-I-V,I=o.get(l+2,l+1),V=Math.abs(R)+Math.abs(A)+Math.abs(I),R/=V,A/=V,I/=V,l!==u)&&!(Math.abs(o.get(l,l-1))*(Math.abs(A)+Math.abs(I))<v*(Math.abs(R)*(Math.abs(o.get(l-1,l-1))+Math.abs(k)+Math.abs(o.get(l+1,l+1)))));)l--;for(n=l+2;n<=y;n++)o.set(n,n-2,0),n>l+2&&o.set(n,n-3,0);for(h=l;h<=y-1&&(M=h!==y-1,h!==l&&(R=o.get(h,h-1),A=o.get(h+1,h-1),I=M?o.get(h+2,h-1):0,c=Math.abs(R)+Math.abs(A)+Math.abs(I),0!==c&&(R/=c,A/=c,I/=c)),0!==c);h++)if(V=Math.sqrt(R*R+A*A+I*I),R<0&&(V=-V),0!==V){for(h!==l?o.set(h,h-1,-V*c):u!==l&&o.set(h,h-1,-o.get(h,h-1)),R+=V,c=R/V,g=A/V,k=I/V,A/=R,I/=R,i=h;i<t;i++)R=o.get(h,i)+A*o.get(h+1,i),M&&(R+=I*o.get(h+2,i),o.set(h+2,i,o.get(h+2,i)-R*k)),o.set(h,i,o.get(h,i)-R*c),o.set(h+1,i,o.get(h+1,i)-R*g);for(n=0;n<=Math.min(y,h+3);n++)R=c*o.get(n,h)+g*o.get(n,h+1),M&&(R+=k*o.get(n,h+2),o.set(n,h+2,o.get(n,h+2)-R*I)),o.set(n,h,o.get(n,h)-R),o.set(n,h+1,o.get(n,h+1)-R*A);for(n=0;n<=x;n++)R=c*s.get(n,h)+g*s.get(n,h+1),M&&(R+=k*s.get(n,h+2),s.set(n,h+2,s.get(n,h+2)-R*I)),s.set(n,h,s.get(n,h)-R),s.set(n,h+1,s.get(n,h+1)-R*A)}}}if(0===S)return;for(y=t-1;y>=0;y--)if(R=r[y],A=e[y],0===A)for(u=y,o.set(y,y,1),n=y-1;n>=0;n--){for(f=o.get(n,n)-R,I=0,i=u;i<=y;i++)I+=o.get(n,i)*o.get(i,y);if(e[n]<0)k=f,V=I;else if(u=n,0===e[n]?o.set(n,y,0!==f?-I/f:-I/(v*S)):(c=o.get(n,n+1),g=o.get(n+1,n),A=(r[n]-R)*(r[n]-R)+e[n]*e[n],a=(c*V-k*I)/A,o.set(n,y,a),o.set(n+1,y,Math.abs(c)>Math.abs(k)?(-I-f*a)/c:(-V-g*a)/k)),a=Math.abs(o.get(n,y)),v*a*a>1)for(i=n;i<=y;i++)o.set(i,y,o.get(i,y)/a)}else if(A<0)for(u=y-1,Math.abs(o.get(y,y-1))>Math.abs(o.get(y-1,y))?(o.set(y-1,y-1,A/o.get(y,y-1)),o.set(y-1,y,-(o.get(y,y)-R)/o.get(y,y-1))):(b=tt(0,-o.get(y-1,y),o.get(y-1,y-1)-R,A),o.set(y-1,y-1,b[0]),o.set(y-1,y,b[1])),o.set(y,y-1,0),o.set(y,y,1),n=y-2;n>=0;n--){for(m=0,w=0,i=u;i<=y;i++)m+=o.get(n,i)*o.get(i,y-1),w+=o.get(n,i)*o.get(i,y);if(f=o.get(n,n)-R,e[n]<0)k=f,I=m,V=w;else if(u=n,0===e[n]?(b=tt(-m,-w,f,A),o.set(n,y-1,b[0]),o.set(n,y,b[1])):(c=o.get(n,n+1),g=o.get(n+1,n),p=(r[n]-R)*(r[n]-R)+e[n]*e[n]-A*A,d=2*(r[n]-R)*A,0===p&&0===d&&(p=v*S*(Math.abs(f)+Math.abs(A)+Math.abs(c)+Math.abs(g)+Math.abs(k))),b=tt(c*I-k*m+A*w,c*V-k*w-A*m,p,d),o.set(n,y-1,b[0]),o.set(n,y,b[1]),Math.abs(c)>Math.abs(k)+Math.abs(A)?(o.set(n+1,y-1,(-m-f*o.get(n,y-1)+A*o.get(n,y))/c),o.set(n+1,y,(-w-f*o.get(n,y)-A*o.get(n,y-1))/c)):(b=tt(-I-g*o.get(n,y-1),-V-g*o.get(n,y),k,A),o.set(n+1,y-1,b[0]),o.set(n+1,y,b[1]))),a=Math.max(Math.abs(o.get(n,y-1)),Math.abs(o.get(n,y))),v*a*a>1)for(i=n;i<=y;i++)o.set(i,y-1,o.get(i,y-1)/a),o.set(i,y,o.get(i,y)/a)}for(n=0;n<t;n++)if(n<0||n>x)for(i=n;i<t;i++)s.set(n,i,o.get(n,i));for(i=t-1;i>=0;i--)for(n=0;n<=x;n++){for(k=0,h=0;h<=Math.min(i,x);h++)k+=s.get(n,h)*o.get(h,i);s.set(n,i,k)}}(n,u,h,i,t)}this.n=n,this.e=u,this.d=h,this.V=i}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,s=this.e,o=this.d,n=new S(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)n.set(t,e,0);n.set(t,t,o[t]),s[t]>0?n.set(t,t+1,s[t]):s[t]<0&&n.set(t,t-1,s[t])}return n}}function tt(t,e,r,s){let o,n;return Math.abs(r)>Math.abs(s)?(o=s/r,n=r+o*s,[(t+o*e)/n,(e-o*t)/n]):(o=r/s,n=s+o*r,[(o*t+e)/n,(o*e-t)/n])}class et{constructor(t){if(!(t=L.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,s,o=t,n=o.rows,i=new S(n,n),h=!0;for(r=0;r<n;r++){let t=0;for(s=0;s<r;s++){let n=0;for(e=0;e<s;e++)n+=i.get(s,e)*i.get(r,e);n=(o.get(r,s)-n)/i.get(s,s),i.set(r,s,n),t+=n*n}for(t=o.get(r,r)-t,h&=t>0,i.set(r,r,Math.sqrt(Math.max(t,0))),s=r+1;s<n;s++)i.set(r,s,0)}this.L=i,this.positiveDefinite=Boolean(h)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=L.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let s,o,n,i=t.columns,h=t.clone();for(n=0;n<r;n++)for(o=0;o<i;o++){for(s=0;s<n;s++)h.set(n,o,h.get(n,o)-h.get(s,o)*e.get(n,s));h.set(n,o,h.get(n,o)/e.get(n,n))}for(n=r-1;n>=0;n--)for(o=0;o<i;o++){for(s=n+1;s<r;s++)h.set(n,o,h.get(n,o)-h.get(s,o)*e.get(s,n));h.set(n,o,h.get(n,o)/e.get(n,n))}return h}get lowerTriangularMatrix(){return this.L}}class rt{constructor(t,e={}){t=L.checkMatrix(t);let{Y:r}=e;const{scaleScores:s=!1,maxIterations:o=1e3,terminationCriteria:n=1e-10}=e;let i;if(r){if(r=Array.isArray(r)&&"number"==typeof r[0]?S.columnVector(r):L.checkMatrix(r),!r.isColumnVector()||r.rows!==t.rows)throw new Error("Y must be a column vector of length X.rows");i=r}else i=t.getColumnVector(0);let h,u,l,a,f=1;for(let e=0;e<o&&f>n;e++)l=t.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0)),l=l.div(l.norm()),h=t.mmul(l).div(l.transpose().mmul(l).get(0,0)),e>0&&(f=h.clone().sub(a).pow(2).sum()),a=h.clone(),r?(u=r.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),u=u.div(u.norm()),i=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):i=h;if(r){let e=t.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));e=e.div(e.norm());let s=t.clone().sub(h.clone().mmul(e.transpose())),o=i.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),n=r.clone().sub(h.clone().mulS(o.get(0,0)).mmul(u.transpose()));this.t=h,this.p=e.transpose(),this.w=l.transpose(),this.q=u,this.u=i,this.s=h.transpose().mmul(h),this.xResidual=s,this.yResidual=n,this.betas=o}else this.w=l.transpose(),this.s=h.transpose().mmul(h).sqrt(),this.t=s?h.clone().div(this.s.get(0,0)):h,this.xResidual=t.sub(h.mmul(l.transpose()))}}}]);
//# sourceMappingURL=graphic-primitives.min.js.map